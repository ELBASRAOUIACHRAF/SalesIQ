<aside class="filter-sidebar">
  <div class="sidebar-header">
    <h3 class="sidebar-title">Filters</h3>
    <button class="reset-link" (click)="resetFilters()" *ngIf="hasActiveFilters()">
      Clear all
    </button>
  </div>

  <!-- CATEGORIES -->
  <section class="filter-section">
    <h4>Categories</h4>
    
    <!-- Loading state -->
    <div *ngIf="isLoadingCategories" class="loading-state">
      <div class="skeleton-checkbox" *ngFor="let i of [1,2,3,4]"></div>
    </div>
    
    <!-- Error state -->
    <div *ngIf="categoriesError && !isLoadingCategories" class="error-state">
      <span>Unable to load categories</span>
    </div>
    
    <!-- Categories list -->
    <div *ngIf="!isLoadingCategories && !categoriesError && categories.length > 0">
      <label class="checkbox" *ngFor="let category of visibleCategories">
        <input type="checkbox"
               [checked]="isCategorySelected(category)"
               (change)="toggleArrayFilter('categories', category, $event)">
        <span class="checkbox-custom"></span>
        <span class="checkbox-label">{{ category.name }}</span>
      </label>
      <button *ngIf="shouldShowCategoriesSeeMore" 
              class="see-more-btn" 
              (click)="toggleCategoriesVisibility()">
        {{ showAllCategories ? 'Show less' : 'Show more' }}
      </button>
    </div>
    
    <!-- Empty state -->
    <div *ngIf="!isLoadingCategories && !categoriesError && categories.length === 0" class="empty-state">
      No categories available
    </div>
  </section>

  <!-- BRANDS -->
  <section class="filter-section" *ngIf="brands.length > 0">
    <h4>Brands</h4>
    
    <div *ngIf="isLoadingBrands" class="loading-state">
      <div class="skeleton-checkbox" *ngFor="let i of [1,2,3]"></div>
    </div>
    
    <div *ngIf="!isLoadingBrands && brands.length > 0">
      <label class="checkbox" *ngFor="let brand of visibleBrands">
        <input type="checkbox"
               [checked]="isBrandSelected(brand)"
               (change)="toggleArrayFilter('brands', brand, $event)">
        <span class="checkbox-custom"></span>
        <span class="checkbox-label">{{ brand }}</span>
      </label>
      <button *ngIf="shouldShowBrandsSeeMore" 
              class="see-more-btn" 
              (click)="toggleBrandsVisibility()">
        {{ showAllBrands ? 'Show less' : 'Show more' }}
      </button>
    </div>
  </section>

  <!-- PRICE -->
  <section class="filter-section">
    <h4>Price Range</h4>
    
    <div class="price-filter">
      <div class="price-display">
        <span class="price-value">${{ filterState.priceMin }}</span>
        <span class="price-separator">—</span>
        <span class="price-value">${{ filterState.priceMax }}</span>
      </div>
      
      <mat-slider
        min="0"
        max="10000"
        step="50"
        (input)="onPriceChange()"
        (change)="onPriceChange()"
        class="price-slider">
        <input matSliderStartThumb [(ngModel)]="filterState.priceMin">
        <input matSliderEndThumb [(ngModel)]="filterState.priceMax">
      </mat-slider>
    </div>

    <div class="price-presets">
      <button *ngFor="let range of priceRanges" 
              class="price-preset-btn"
              [class.active]="filterState.priceMin === range.min && filterState.priceMax === range.max"
              (click)="selectPriceRange(range)">
        {{ range.label }}
      </button>
    </div>
  </section>

  <!-- REVIEWS -->
  <section class="filter-section">
    <h4>Customer Rating</h4>
    <div class="rating-options">
      <button class="rating-option"
              *ngFor="let r of availableRatings"
              [class.selected]="isRatingSelected(r)"
              (click)="setRating(r)">
        <span class="stars">
          <span class="star filled" *ngFor="let s of [1,2,3,4,5].slice(0, r)">★</span>
          <span class="star empty" *ngFor="let s of [1,2,3,4,5].slice(r)">★</span>
        </span>
        <span class="rating-text">& Up</span>
      </button>
    </div>
  </section>

  <!-- RESET BUTTON -->
  <section class="filter-actions">
    <button class="reset-button" (click)="resetFilters()">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
        <path d="M1 4v6h6M23 20v-6h-6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Reset Filters
    </button>
  </section>
</aside>