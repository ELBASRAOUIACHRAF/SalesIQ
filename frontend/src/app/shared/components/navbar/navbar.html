<nav class="navbar-container">

  <div class="main-header">
    <div class="content-wrapper">
      <div class="header-left">
        <div class="logo" routerLink="/">
          <span class="logo-text">SalesIQ</span> 
        </div>
        <ul class="top-nav-links">
          <li *ngFor="let link of topNavLinks">
            <a [routerLink]="link.route" routerLinkActive="active-link" [routerLinkActiveOptions]="{exact: true}">{{ link.label }}</a>
          </li>
        </ul>
      </div>

      <div class="search-bar-container">
        <input 
          #searchInput
          type="text" 
          placeholder="Search for products, brands and more" 
          class="search-input"
          [(ngModel)]="searchQuery" 
          (keyup.enter)="onSearch()"
          (focus)="showSearchHistory()" 
          (blur)="hideSearchHistory()" 
        >
        <button class="search-icon" (click)="onSearch()">
          <mat-icon>search</mat-icon>
        </button>
    
        @if (isSearchHistoryVisible && searchHistory.length > 0) {
          <div class="search-history-dropdown">
            <ul>
              @for (item of searchHistory; track item.id) {
                <li (mousedown)="selectHistoryItem(item.query)">
                    <mat-icon>history</mat-icon>
                    <span>{{ item.query }}</span>
                    <span class="delete-btn" (mousedown)="$event.stopPropagation(); deleteHistoryItem($event, item.id)">×</span>
                </li>
              }
            </ul>
          </div>
        }
    </div>

      <div class="action-icons">
          <a routerLink="/account" class="icon-link">
            <mat-icon>person</mat-icon>
          </a>
        
          <a routerLink="/wishlist" class="icon-link">
            <mat-icon>favorite_border</mat-icon>
          </a>
        
          <a routerLink="/cart" class="icon-link cart-icon">
            <mat-icon>shopping_cart</mat-icon>
            @if (cartCount > 0) {
              <span class="cart-count">{{ cartCount }}</span>
            }
          </a>
        </div>
    </div>
  </div>

  <div class="secondary-nav-bar">
    <div class="content-wrapper">
      <ul class="main-nav-links">
        @for (link of mainNavLinks; track link.label) {
          <li [class.has-dropdown]="link.hasDropdown" 
              [class.megamenu-active]="link.label === 'Megamenu' && isMegamenuOpen">
            
            <a [routerLink]="link.route" (click)="link.label === 'Megamenu' ? toggleMegamenu($event) : null">
              {{ link.label }}
              @if (link.hasDropdown) {
                <span class="dropdown-arrow">▼</span>
              }
            </a>
              
            @if (link.label === 'Megamenu' && isMegamenuOpen) {
              <div class="megamenu-dropdown">
                <h5 style="margin-top:0">Quick Access</h5>
                <ul>
                  <li><a href="#">New Arrivals</a></li>
                  <li><a href="#">Best Sellers</a></li>
                  <li><a href="#">Discounted Items</a></li>
                </ul>
              </div>
            }
          </li>
        }
      </ul>
      
      <span class="shipping-info">Free Shipping on Orders up to <span>$50</span></span>
    </div>
  </div>
  
</nav>