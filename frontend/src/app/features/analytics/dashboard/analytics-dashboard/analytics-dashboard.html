<div class="dashboard-content">

  <div class="dashboard-header">
    <app-top-bar
      [title]="'Analytics Dashboard'"
      [tabs]="[]"
      [activeTab]="''"
      [dateText]="currentDateText"
      [buttonLabel]="'REFRESH'"
      (buttonClick)="refresh()"
    ></app-top-bar>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="loading-spinner"></div>
    <p>Loading dashboard data...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error && !loading" class="error-state">
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="refresh()">Retry</button>
  </div>

  <!-- Dashboard Content -->
  <ng-container *ngIf="!loading && !error">

    <!-- Welcome Banner -->
    <div class="welcome-banner">
      <div class="welcome-content">
        <h1>ðŸ‘‹ Welcome back!</h1>
        <p>Here's what's happening with your business today</p>
      </div>
      <div class="quick-stats">
        <div class="quick-stat">
          <span class="stat-value">{{ lastUpdated }}</span>
          <span class="stat-label">Last Updated</span>
        </div>
        <div class="quick-stat">
          <span class="stat-value">{{ healthStatus }}</span>
          <span class="stat-label">Health Status</span>
        </div>
      </div>
    </div>
    
    <!-- Main KPI Cards -->
    <section class="dashboard-section">
      <h2 class="section-title">ðŸ“Š Key Performance Metrics</h2>
      <div class="kpi-cards-grid">
        <app-kpi-card
          *ngFor="let k of kpis"
          [title]="k.title"
          [value]="k.value"
          [subtitle]="k.subtitle"
          [change]="k.change"
          [sparkline]="k.sparkline"
          [accentColor]="k.accentColor"
        ></app-kpi-card>
      </div>
    </section>

    <!-- Charts Section -->
    <section class="dashboard-section charts-section">
      <h2 class="section-title">ðŸ“ˆ Performance Trends</h2>
      <div class="chart-cards-grid">
        <app-chart-kpi-card
          *ngFor="let c of chartCards"
          [title]="c.title"
          [value]="c.value"
          [subtitle]="c.subtitle"
          [color]="c.color"
          [data]="c.data"
          [xAxisLabels]="['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']"
          [showAxes]="true"
        ></app-chart-kpi-card>
      </div>
    </section>

    <!-- Bottom Row: Pie Chart + Quick Insights -->
    <div class="bottom-row">
      <!-- Customer Distribution -->
      <section class="dashboard-section pie-container">
        <h2 class="section-title">ðŸ‘¥ Customer Distribution</h2>
        <div class="pie-section">
          <app-kpi-pie-chart
            title="Customer Types"
            [value]="pieTotal"
            subtitle="Total customers"
            [segments]="pieData"
          ></app-kpi-pie-chart>
        </div>
      </section>

      <!-- Quick Insights -->
      <section class="dashboard-section insights-container">
        <h2 class="section-title">ðŸ’¡ Quick Insights</h2>
        <div class="insights-list">
          <div class="insight-item" *ngFor="let insight of insights">
            <span class="insight-icon">{{ insight.icon }}</span>
            <div class="insight-content">
              <span class="insight-title">{{ insight.title }}</span>
              <span class="insight-value">{{ insight.value }}</span>
            </div>
          </div>
        </div>
      </section>
    </div>

  </ng-container>

</div>

