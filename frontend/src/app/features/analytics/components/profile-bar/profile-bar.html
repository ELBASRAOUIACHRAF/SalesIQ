<div class="profile-bar" [class.compact]="compact" [class.loading]="isLoading" [class.error]="loadError" role="group" aria-label="profile and notifications">
  <!-- Notification Bell -->
  <div class="notification-wrapper">
    <button class="notif" aria-label="notifications" (click)="toggleNotificationPanel($event)">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <path d="M13.73 21a2 2 0 0 1-3.46 0" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      <span class="badge" *ngIf="unreadCount > 0">{{ unreadCount > 99 ? '99+' : unreadCount }}</span>
    </button>

  <!-- <div class="profile" tabindex="0" aria-label="profile" (click)="navigateToProfile()" style="cursor: pointer;">
    <div class="avatar" aria-hidden="true">{{ (userName || '').slice(0,1).toUpperCase() }}</div>
    <div class="name" *ngIf="!compact">{{ userName }}</div> -->
    <!-- Notification Panel -->
    <div class="notification-panel" *ngIf="notificationPanelOpen" (click)="$event.stopPropagation()">
      <div class="panel-header">
        <h3>ðŸ”” Notifications</h3>
        <div class="panel-actions">
          <button class="action-btn" (click)="refreshNotifications()" title="Refresh">ðŸ”„</button>
          <button class="action-btn" (click)="markAllAsRead()" title="Mark all read" *ngIf="unreadCount > 0">âœ“</button>
        </div>
      </div>
      
      <div class="notification-list" *ngIf="notifications.length > 0">
        <a 
          *ngFor="let notif of notifications" 
          class="notification-item" 
          [class.unread]="!notif.read"
          [class.critical]="notif.severity === 'critical'"
          [class.warning]="notif.severity === 'warning'"
          [routerLink]="notif.actionUrl"
          (click)="markAsRead(notif, $event)"
        >
          <span class="notif-icon">{{ getTypeIcon(notif.type) }}</span>
          <div class="notif-content">
            <div class="notif-title">{{ notif.title }}</div>
            <div class="notif-message">{{ notif.message }}</div>
            <div class="notif-time">{{ formatTime(notif.timestamp) }}</div>
          </div>
          <span class="severity-indicator" *ngIf="!notif.read">{{ getSeverityIcon(notif.severity) }}</span>
        </a>
      </div>
      
      <div class="empty-state" *ngIf="notifications.length === 0">
        <span class="empty-icon">ðŸŽ‰</span>
        <p>No notifications</p>
        <small>You're all caught up!</small>
      </div>
    </div>
  </div>

  <!-- Help Button -->
  <button class="help-btn" aria-label="help">?</button>

  <!-- Profile -->
  <div class="profile" [class.profile-loading]="isLoading" [class.profile-error]="loadError" tabindex="0" aria-label="profile">
    <div class="avatar" [class.avatar-loading]="isLoading" [class.avatar-error]="loadError" aria-hidden="true">{{ displayInitial }}</div>
    <div class="name" *ngIf="!compact">{{ displayName }}</div>
  </div>
</div>
